From b2c7b1c960367ba22a6cb9ca6a1931af3f708cc7 Mon Sep 17 00:00:00 2001
From: Yang Chen <chenyang@cs.utah.edu>
Date: Fri, 18 Jul 2014 00:23:02 -0700
Subject: [PATCH 27/27] Fixed an API compatibility issue

Now working with llvm-r213171
---
 clang_delta/Makefile.am               | 2 +-
 clang_delta/Makefile.in               | 2 +-
 clang_delta/TransformationManager.cpp | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/clang_delta/Makefile.am b/clang_delta/Makefile.am
index 6530ca7..a35edd0 100644
--- a/clang_delta/Makefile.am
+++ b/clang_delta/Makefile.am
@@ -48,7 +48,7 @@ clang_delta_CXXFLAGS = \
 clang_delta_LDADD = \
 	-lclangFrontendTool -lclangFrontend -lclangDriver -lclangSerialization \
 	-lclangCodeGen -lclangParse -lclangSema -lclangAnalysis \
-	-lclangRewriteCore -lclangAST -lclangBasic -lclangEdit -lclangLex \
+	-lclangRewriteFrontend -lclangRewrite -lclangAST -lclangBasic -lclangEdit -lclangLex \
 	$(LLVMLIBS) \
 	$(LLVMLDFLAGS)
 
diff --git a/clang_delta/Makefile.in b/clang_delta/Makefile.in
index 2f403f2..70e3fd1 100644
--- a/clang_delta/Makefile.in
+++ b/clang_delta/Makefile.in
@@ -431,7 +431,7 @@ clang_delta_CXXFLAGS = \
 clang_delta_LDADD = \
 	-lclangFrontendTool -lclangFrontend -lclangDriver -lclangSerialization \
 	-lclangCodeGen -lclangParse -lclangSema -lclangAnalysis \
-	-lclangRewriteCore -lclangAST -lclangBasic -lclangEdit -lclangLex \
+	-lclangRewriteFrontend -lclangRewrite -lclangAST -lclangBasic -lclangEdit -lclangLex \
 	$(LLVMLIBS) \
 	$(LLVMLDFLAGS)
 
diff --git a/clang_delta/TransformationManager.cpp b/clang_delta/TransformationManager.cpp
index da56a97..c6aaec6 100644
--- a/clang_delta/TransformationManager.cpp
+++ b/clang_delta/TransformationManager.cpp
@@ -112,7 +112,7 @@ bool TransformationManager::initializeCompilerInstance(std::string &ErrorMsg)
   TargetOpts.Triple = LLVM_DEFAULT_TARGET_TRIPLE;
   TargetInfo *Target = 
     TargetInfo::CreateTargetInfo(ClangInstance->getDiagnostics(),
-                                 &TargetOpts);
+                                 ClangInstance->getInvocation().TargetOpts);
   ClangInstance->setTarget(Target);
   ClangInstance->createFileManager();
   ClangInstance->createSourceManager(ClangInstance->getFileManager());
-- 
2.0.4

