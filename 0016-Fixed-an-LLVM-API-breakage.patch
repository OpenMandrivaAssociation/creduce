From aa928a6ed5ecd4ee9752d4ea435c2b7484c607b7 Mon Sep 17 00:00:00 2001
From: Yang Chen <chenyang@cs.utah.edu>
Date: Wed, 7 May 2014 22:05:11 -0700
Subject: [PATCH 16/27] Fixed an LLVM API breakage

now working with r208276

Thanks Markus Trippelsdorf for the patch!
---
 clang_delta/EmptyStructToInt.cpp | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/clang_delta/EmptyStructToInt.cpp b/clang_delta/EmptyStructToInt.cpp
index e8e759e..60c86cf 100644
--- a/clang_delta/EmptyStructToInt.cpp
+++ b/clang_delta/EmptyStructToInt.cpp
@@ -20,6 +20,7 @@
 #include "clang/AST/RecordLayout.h"
 #include "clang/AST/RecursiveASTVisitor.h"
 #include "clang/AST/ASTContext.h"
+#include "llvm/ADT/StringRef.h"
 #include "TransformationManager.h"
 
 using namespace clang;
@@ -165,9 +166,10 @@ bool EmptyStructToIntRewriteVisitor::VisitElaboratedTypeLoc(
   // We need to omit it.
   if (StartBuf > EndBuf) {
     SourceLocation KeywordLoc = Loc.getElaboratedKeywordLoc();
-    const char *Keyword = TypeWithKeyword::getKeywordName(ETy->getKeyword());
+    const llvm::StringRef Keyword = 
+      TypeWithKeyword::getKeywordName(ETy->getKeyword());
     ConsumerInstance->TheRewriter.ReplaceText(KeywordLoc, 
-                                              strlen(Keyword), "int");
+                                              Keyword.size(), "int");
     return true;
   }
   
-- 
2.0.4

